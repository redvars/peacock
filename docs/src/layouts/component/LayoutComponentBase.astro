---
import site from '../../_data/site.json';
interface Props {
  componentDetails: any;
}

const { componentDetails } = Astro.props;

import Layout from './../Default.astro';
import '../../styles/component.layout.scss';
import { getCategoriesTree, getComponentDetails, getNextAndPrevious } from '../../_data/getComponentDetails';
import Footer from '../../components/Footer.astro';

const title = componentDetails.metadata.name;
const description = componentDetails.metadata.description;
const { nextComponent, previousComponent } = getNextAndPrevious(componentDetails.tag);
---

<Layout title={title} description={description}  classes={'surface'}>
  <div class="sidenav m-hide surface" id="component-page">
    <div class="sidenav-components">
      <pc-tree-view layer="01" value={title} selected-node={title}>
        <pc-tree-node label="Overview" href="/components"></pc-tree-node>

        {
          getCategoriesTree().map(category => {
            if (!category.hide) {
              return (
                <pc-tree-node label={category.name} value={category.name + 'group'}>
                  {category.children.map(componentName => {
                    if (typeof componentName === 'string') {
                      const component = getComponentDetails(componentName);
                      if (component.metadata.name) {
                        return <pc-tree-node label={component.metadata.name} value={component.metadata.name} href={`/components/${component.tag.replace('goat-', '')}/`} />;
                      }
                    } else if (componentName.children) {
                      return (
                        <pc-tree-node label={componentName.name} value={componentName.name + 'group'}>
                          {componentName.children.map(componentName => {
                            const component = getComponentDetails(componentName);
                            if (component.metadata.name) {
                              return <pc-tree-node label={component.metadata.name} value={component.metadata.name} href={`/components/${component.tag.replace('goat-', '')}/`} />;
                            }
                          })}
                        </pc-tree-node>
                      );
                    }
                  })}
                </pc-tree-node>
              );
            }
          })
        }
      </pc-tree-view>
    </div>
  </div>
  <div class="main-content">
    <pc-container class="page-wrapper">
      <slot />

      <div class="previous-next-nav">
        <p-button href={`/components/${previousComponent.metadata.name}/`} icon-align="left">
          <p-icon slot='icon' name='arrow_left'></p-icon> Previous
        </p-button>
        <p-button kind="simple" href={`/components/${nextComponent.metadata.name}/`}> Next <p-icon slot='icon' name='arrow_right'>Previous</p-icon> </p-button>
      </div>
    </pc-container>

    <div class="footer container">
      <pc-divider></pc-divider>
      <Footer />
    </div>
  </div>
</Layout>
